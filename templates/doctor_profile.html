{% extends 'base.html' %}
{% block title %}Doctor Profile - {{ doctor.user.full_name }}{% endblock %}
{% block content %}
<div class="page-header">
  <div class="d-flex justify-content-between align-items-center">
    <div>
      <h3><i class="bi bi-person-badge me-2"></i>Dr. {{ doctor.user.full_name }}</h3>
      <p class="text-muted mb-0">{{ doctor.specialization }} | {{ doctor.department.name if doctor.department else 'General Practice' }}</p>
    </div>
    <div>
      <a class="btn btn-outline-secondary" href="{{ url_for('patient_dashboard') }}">
        <i class="bi bi-arrow-left me-2"></i>Back to Dashboard
      </a>
    </div>
  </div>
</div>

<div class="content-area">
  <div class="row">
    <div class="col-md-4">
      <div class="card">
        <div class="card-body text-center">
          <i class="bi bi-person-badge text-success" style="font-size: 4rem;"></i>
          <h5 class="mt-3 mb-1">Dr. {{ doctor.user.full_name }}</h5>
          <p class="text-muted mb-2">{{ doctor.specialization }}</p>
          {% if doctor.department %}
            <p class="text-muted small">
              <i class="bi bi-building me-1"></i>{{ doctor.department.name }}
            </p>
          {% endif %}
        </div>
      </div>
    </div>
    
    <div class="col-md-8">
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0">
            <i class="bi bi-calendar-week me-2"></i>Book Appointment
          </h5>
        </div>
        <div class="card-body">
          <form method="post">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="date" class="form-label">
                  <i class="bi bi-calendar me-1"></i>Choose Date
                </label>
                <select name="date" id="date" class="form-select" required>
                  <option value="">Select a date</option>
                  {% for d in next7 %}
                    <option value="{{ d.isoformat() }}">{{ d.strftime('%B %d, %Y') }}</option>
                  {% endfor %}
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label for="time" class="form-label">
                  <i class="bi bi-clock me-1"></i>Available Time Slots
                </label>
                <select name="time" id="time" class="form-select" required>
                  <option value="">Select a time slot</option>
                  {% for d in next7 %}
                    {% set ds = availability.get(d.isoformat(), []) %}
                    {% for t in ds %}
                      <option value="{{ t }}">{{ t }}</option>
                    {% endfor %}
                  {% endfor %}
                </select>
                {% if not availability %}
                  <div class="form-text text-warning">
                    <i class="bi bi-exclamation-triangle me-1"></i>
                    This doctor hasn't set their availability yet. Please contact the admin.
                  </div>
                {% endif %}
              </div>
            </div>
            
            <div class="d-flex gap-2">
              <button type="submit" class="btn btn-primary" {% if not availability %}disabled{% endif %}>
                <i class="bi bi-calendar-plus me-2"></i>Book Appointment
              </button>
              <a class="btn btn-outline-secondary" href="{{ url_for('search_doctors') }}">
                <i class="bi bi-search me-2"></i>Find Another Doctor
              </a>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
